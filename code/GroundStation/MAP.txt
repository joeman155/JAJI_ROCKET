Summary
-----------
Shows information on how I set-up configured the map system

It is probably a VERY good idea to load the maps into a plsql DB on a FAST system...
export the loaded DB...
Import into a slow system.

This is bcause running osmosis and osm2pgsql on slow Rasberry-Pi 2 Model B is painful
and it might damage microSD....too many writes...possibly.

OS Deps
--------
Log on as user root

apt-get install postgresql postgresql-contrib

apt-get install osm2pgsql 



Downloading the map
---------------------
Went to:-

http://www.openstreetmap.org

Click on Export

Clicked on hyper link "Manually select a different area"

Choose the area I wanted 

Clicked on hyperlink "Overpass API" and let it download


** Didn't work ...download failed..


Went to:-

http://download.geofabrik.de/

When to "Australia and Oceana" -> Australia 

Download


wget http://download.geofabrik.de/australia-oceania/australia-latest.osm.bz2

bunzip2 australia-latest.osm.bz2



Extracting a 'region' of Australia map for load
--------------

apt-get install osmosis

Create a file called east.poly  


osmosis --read-xml file="australia-latest.osm" --bounding-polygon file="east.poly" \
        --write-xml file="east.australia-latest.osm"


bzip2 east.australia-latest.osm


or

osmosis --read-xml file="australia-latest.osm" --bounding-polygon file="qld.poly" \
        --write-xml file="qld.australia-latest.osm"


bzip2 qld.australia-latest.osm

Then Transfer this file to /data/maps


NOTE: Sample scripts and poly files are in the maps directory



Installing map software
---------------
Log on as user root

su - postgres

createdb gis

psql -d gis

createlang plpgsql gis                                         

control-d


cd /usr/share/postgresql/9.1/contrib/postgis-1.5/
psql -d gis -f postgis.sql                                            

cd /usr/share/postgresql/9.1/contrib
psql -d gis -f postgis_comments.sql                                   

psql -d gis 
create extension hstore;

control-d

cd /usr/share/postgresql/9.1/contrib/postgis-1.5
psql -d gis -f spatial_ref_sys.sql  





Installing fresh map
------------------
as postgres user:-


Here is an example of loading QLD map

cd /data/maps/
osm2pgsql qld.australia-latest.osm.bz2 -d gis -U postgres -P 5432 \
          -S /usr/share/osm2pgsql/default.style --hstore


Transferring Postgres database to slower system
------------
On fast source system, type:-


pg_dump gis > /tmp/gis.dmp

Transfer to slow system


Create GIS database as follows:-

createuser pi   # anser yes for superuser
createdb -E UTF8 -O pi gis

psql -U pi -d gis

createlang plpgsql gis

create extension hstore;

control-d



Then import database:-

psql gis < gis.dmp



Open 
/etc/postgresql/9.1/main/pg_hba.conf

Add the line:-

local   gis             pi                                      trust


service postgresql restart
